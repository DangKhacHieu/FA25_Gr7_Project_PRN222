    @model IEnumerable<DAL.Models.Customer>

    @{
       @* Layout = null;*@
        ViewData["Title"] = "Customer List";

        // Lấy dữ liệu phân trang
        int currentPage = ViewData["CurrentPage"] != null ? (int)ViewData["CurrentPage"] : 1;
        int totalPages = ViewData["TotalPages"] != null ? (int)ViewData["TotalPages"] : 1;
        string currentFilter = ViewData["CurrentFilter"] as string ?? "";
        string noResultsMessage = ViewData["NoResultsMessage"] as string ?? "";
    }

    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>@ViewData["Title"]</title>

        <!-- Bootstrap & Icons -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />

        <!-- Custom CSS -->
        <link rel="stylesheet" href="~/css/ManageCustomer.css" />
    </head>
    <body>
        <div class="layout-container">
            <!-- Sidebar -->
           @*<div class="sidebar-container">
                @Html.Partial("~/Views/Shared/_Sidebar.cshtml")
            </div> *@

            <!-- Main content -->
            <div class="main-content">
                <h2 class="mb-4 fw-semibold">
                    <i class="bi bi-people-fill text-primary me-2"></i>Customer List
                </h2>

                <!-- Search + Create button -->
                <form method="get" class="d-flex" style="max-width:500px;">
                    <div class="input-group">
                        <span class="input-group-text bg-primary text-white">
                            <i class="bi bi-search"></i>
                        </span>

                        <!-- Input có gợi ý -->
                        <input id="searchBox"
                               type="text"
                               name="searchString"
                               list="customerSuggestions"
                               value="@currentFilter"
                               class="form-control"
                               placeholder="Search Customer..." />

                        <!-- Gợi ý hiển thị (tùy chỉnh bằng datalist) -->
                        <datalist id="customerSuggestions">
                            @foreach (var c in Model)
                            {
                                <option value="@c.FullName"></option>
                            }
                        </datalist>

                        <button type="submit" class="btn btn-primary">Search</button>
                    </div>
                </form>



                <!-- Table -->
                <table class="table table-hover align-middle shadow-sm rounded">
                    <thead class="text-center table-light">
                        <tr>
                            <th>Tên khách hàng</th>
                            <th>Điện thoại</th>
                            <th>Địa chỉ</th>
                            <th>Giới tính</th>
                            <th>Trạng thái</th>
                            <th>Hành động</th>
                        </tr>
                    </thead>
                    <tbody id="customerTableBody">
                        @if (Model != null && Model.Any())
                        {
                            foreach (var item in Model)
                            {
                                <tr class="text-center">
                                    <td class="text-start">
                                        <div class="d-flex align-items-center">
                                            <img src="~/images/avatar.png" class="rounded-circle me-2 border" style="width:45px; height:45px;" alt="avatar" />
                                            <span>@item.FullName</span>
                                        </div>
                                    </td>
                                    <td>@item.PhoneNumber</td>
                                    <td>@item.Address</td>
                                    <td>@item.Sex</td>
                                    <td>
                                        @if (item.Status == 0)
                                        {
                                            <span class="badge bg-success">Đang hoạt động</span>
                                        }
                                        else if (item.Status == 1)
                                        {
                                            <span class="badge bg-danger">Blocked</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-secondary">Deleted</span>
                                        }
                                    </td>
                                    <td>
                                        <div class="btn-group">
                                            @if (item.Status == 1)
                                            {
                                                <a asp-action="ToggleStatus" asp-route-id="@item.CustomerId" class="btn btn-sm btn-danger" title="Unblock">
                                                    <i class="bi bi-person-x-fill"></i>
                                                </a>
                                            }
                                            else
                                            {
                                                <a asp-action="ToggleStatus" asp-route-id="@item.CustomerId" class="btn btn-sm btn-success" title="Block">
                                                    <i class="bi bi-person-check-fill"></i>
                                                </a>
                                            }

                                            <a asp-action="Delete" asp-route-id="@item.CustomerId" class="btn btn-sm btn-warning" title="Delete">
                                                <i class="bi bi-trash-fill"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="6" class="text-center text-warning fw-semibold">
                                    @(!string.IsNullOrEmpty(noResultsMessage) ? noResultsMessage : "Không tìm thấy khách hàng phù hợp.")
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

                <!-- Pagination -->
                @if (totalPages > 1)
                {
                    <div class="pagination-wrapper mt-3">
                        <nav aria-label="Customer pagination">
                            <ul class="pagination justify-content-center mb-0">
                                <!-- Previous -->
                                <li class="page-item @(currentPage == 1 ? "disabled" : "")">
                                    <a class="page-link" href="@Url.Action("Index", new { page = currentPage - 1, searchString = currentFilter })">Previous</a>
                                </li>

                                <!-- Page numbers -->
                                @for (int i = 1; i <= totalPages; i++)
                                {
                                    <li class="page-item @(i == currentPage ? "active" : "")">
                                        <a class="page-link" href="@Url.Action("Index", new { page = i, searchString = currentFilter })">@i</a>
                                    </li>
                                }

                                <!-- Next -->
                                <li class="page-item @(currentPage == totalPages ? "disabled" : "")">
                                    <a class="page-link" href="@Url.Action("Index", new { page = currentPage + 1, searchString = currentFilter })">Next</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                }
            </div>
        </div>

        <!-- Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
        @section Scripts {
            <script src="~/js/ManageCustomer.js"></script>
        }


    </body>
    </html>
